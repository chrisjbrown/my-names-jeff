{"version":3,"file":"my-names-jeff.min.js","sources":["constants.js","module.js"],"sourcesContent":["export const moduleId = \"my-names-jeff\";\nexport const tokenTypes = [\n  \"Human\",\n  \"Dragon\",\n  \"Dwarf\",\n  \"Elf\",\n  \"Gnome\",\n  \"Goblin\",\n  \"Halfling\",\n  \"Orc\",\n  \"Tiefling\"\n];\n","// Do not remove this import. If you do Vite will think your styles are dead\n// code and not include them in the build output.\nimport { moduleId, tokenTypes } from \"./constants\";\n\n// Load templates\nloadTemplates([\n  \"../templates/token-config.hbs\",\n  \"../templates/token-types.hbs\"\n]);\n\nlet NAME_TYPES_SHOWN = false;\n\n/**\n *\n * @param name\n */\nasync function getTableFromPack(name) {\n  const pack = game.packs.get(\"my-names-jeff.person-names\");\n  const entry = Array.from(pack.index).find(e => e.name == name);\n  return await pack.getDocument(entry?._id);\n}\n\n/**\n *\n * @param type\n * @param token\n */\nasync function setName(type, token) {\n  if (!token) {\n    console.error(\"my-names-jeff\", \"Token not found\");\n    return;\n  }\n\n  if (type === \"Dragon\") {\n    try {\n      const dragonNameTable = await getTableFromPack(\"Dragon Name\");\n      const dragonName = await dragonNameTable.roll();\n      token.document.update({ name: `${dragonName.results[0].text}` });\n    } catch(error) {\n      console.error(\"my-names-jeff\", \"Error getting Dragon name\");\n    }\n  } else {\n    try {\n      const [firstNameTable, lastNameTable] = await Promise.all([\n        getTableFromPack(`${type} First Name`),\n        getTableFromPack(`${type} Last Name`)\n      ]);\n      const [firstName, lastName] = await Promise.all([\n        firstNameTable.roll(),\n        lastNameTable.roll()\n      ]);\n\n      token.document.update({\n        name: `${firstName.results[0].text} ${lastName.results[0].text}`\n      });\n    } catch(error) {\n      console.error(\"my-names-jeff\", `Error getting ${type} name`);\n    }\n  }\n}\n\n/**\n *\n * @param html\n * @param token\n */\nasync function renderNameTypes(html, token) {\n  if (NAME_TYPES_SHOWN) {\n    html.find(\".my-names-jeff.token-names-wrap\")?.remove();\n    NAME_TYPES_SHOWN = false;\n    return;\n  }\n\n  NAME_TYPES_SHOWN = true;\n  const tokenNameButtonTemplate = await renderTemplate(\n    \"modules/my-names-jeff/templates/token-types.hbs\",\n    { types: tokenTypes }\n  );\n\n  html.find(\".col.left\")?.append(tokenNameButtonTemplate);\n\n  const tokenNameButtons = html.find(\".my-names-jeff.token-names-wrap\").find(\"button\");\n  tokenNameButtons.on(\"click\", async e => {\n    await setName(e.target.value, token);\n    NAME_TYPES_SHOWN = false;\n  });\n}\n\nHooks.once(\"init\", () => {\n  console.log(`Initializing ${moduleId}`);\n});\n\nHooks.on(\"renderTokenHUD\", (hud, html) => {\n  if (!game.user.isGM || hud.object.document.actorLink ) return;\n\n  const token = hud.object;\n  html[0].querySelector(\".control-icon[data-action=\\\"config\\\"]\")\n    .insertAdjacentHTML(\"beforebegin\", `\n      <div class=\"control-icon\" data-action=\"token-name\">\n        <i class=\"fas fa-person\"></i>\n      </div>\n    `);\n\n  const tokenNameButton = html.find(\".control-icon[data-action=\\\"token-name\\\"]\");\n\n  tokenNameButton.on(\"click\", async event => {\n    event.preventDefault();\n    renderNameTypes(html, token);\n  });\n});\n"],"names":["moduleId","tokenTypes","loadTemplates","NAME_TYPES_SHOWN","async","getTableFromPack","name","pack","game","packs","get","entry","Array","from","index","find","e","getDocument","_id","renderNameTypes","html","token","remove","tokenNameButtonTemplate","renderTemplate","types","append","on","setName","type","dragonNameTable","dragonName","roll","document","update","results","text","error","console","firstNameTable","lastNameTable","Promise","all","firstName","lastName","target","value","Hooks","once","log","hud","user","isGM","object","actorLink","querySelector","insertAdjacentHTML","event","preventDefault"],"mappings":"AAAY,MAACA,EAAW,gBACXC,EAAa,CACxB,QACA,SACA,QACA,MACA,QACA,SACA,WACA,MACA,YCLFC,cAAc,CACZ,gCACA,iCAGF,IAAIC,GAAmB,EAMvBC,eAAeC,iBAAiBC,GAC9B,MAAMC,EAAOC,KAAKC,MAAMC,IAAI,8BACtBC,EAAQC,MAAMC,KAAKN,EAAKO,OAAOC,MAAKC,GAAKA,EAAEV,MAAQA,IACzD,aAAaC,EAAKU,YAAYN,GAAOO,IACvC,CA8CAd,eAAee,gBAAgBC,EAAMC,GACnC,GAAIlB,EAGF,OAFAiB,EAAKL,KAAK,oCAAoCO,cAC9CnB,GAAmB,GAIrBA,GAAmB,EACnB,MAAMoB,QAAgCC,eACpC,kDACA,CAAEC,MAAOxB,IAGXmB,EAAKL,KAAK,cAAcW,OAAOH,GAENH,EAAKL,KAAK,mCAAmCA,KAAK,UAC1DY,GAAG,SAASvB,gBAvD/BA,eAAewB,QAAQC,EAAMR,GAC3B,GAAKA,EAKL,GAAa,WAATQ,EACF,IACE,MAAMC,QAAwBzB,iBAAiB,eACzC0B,QAAmBD,EAAgBE,OACzCX,EAAMY,SAASC,OAAO,CAAE5B,KAAM,GAAGyB,EAAWI,QAAQ,GAAGC,QACxD,CAAC,MAAMC,GACNC,QAAQD,MAAM,gBAAiB,4BAChC,MAED,IACE,MAAOE,EAAgBC,SAAuBC,QAAQC,IAAI,CACxDrC,iBAAiB,GAAGwB,gBACpBxB,iBAAiB,GAAGwB,kBAEfc,EAAWC,SAAkBH,QAAQC,IAAI,CAC9CH,EAAeP,OACfQ,EAAcR,SAGhBX,EAAMY,SAASC,OAAO,CACpB5B,KAAM,GAAGqC,EAAUR,QAAQ,GAAGC,QAAQQ,EAAST,QAAQ,GAAGC,QAE7D,CAAC,MAAMC,GACNC,QAAQD,MAAM,gBAAiB,iBAAiBR,SACjD,MA5BDS,QAAQD,MAAM,gBAAiB,kBA8BnC,CAwBUT,CAAQZ,EAAE6B,OAAOC,MAAOzB,GAC9BlB,GAAmB,CAAK,GAE5B,CAEA4C,MAAMC,KAAK,QAAQ,KACjBV,QAAQW,IAAI,gBAAgBjD,IAAW,IAGzC+C,MAAMpB,GAAG,kBAAkB,CAACuB,EAAK9B,KAC/B,IAAKZ,KAAK2C,KAAKC,MAAQF,EAAIG,OAAOpB,SAASqB,UAAY,OAEvD,MAAMjC,EAAQ6B,EAAIG,OAClBjC,EAAK,GAAGmC,cAAc,uCACnBC,mBAAmB,cAAe,0HAMbpC,EAAKL,KAAK,2CAElBY,GAAG,SAASvB,UAC1BqD,EAAMC,iBACNvC,gBAAgBC,EAAMC,EAAM,GAC5B"}